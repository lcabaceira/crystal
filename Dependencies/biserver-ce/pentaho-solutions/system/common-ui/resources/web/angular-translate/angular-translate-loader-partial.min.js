/*!
 * angular-translate - v2.1.0 - 2014-09-04
 * http://github.com/PascalPrecht/angular-translate
 * Copyright (c) 2014 ; Licensed MIT
 */
angular.module("pascalprecht.translate").provider("$translatePartialLoader",function(){function a(a){this.name=a,this.isActive=!0,this.tables={}}function b(a){return f.hasOwnProperty(a)}function c(a){return angular.isString(a)&&""!==a}function d(a){if(!c(a))throw new TypeError("Invalid type of a first argument, a non-empty string expected.");return b(a)&&f[a].isActive}function e(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},e(a[c],b[c])):a[c]=b[c];return a}a.prototype.parseUrl=function(a,b){return a.replace(/\{part\}/g,this.name).replace(/\{lang\}/g,b)},a.prototype.getTable=function(a,b,c,d,e,f){var g=b.defer();if(this.tables[a])g.resolve(this.tables[a]);else{var h=this;c({method:"GET",url:this.parseUrl(d,a)}).success(function(b){f&&(b=f(b)),h.tables[a]=b,g.resolve(b)}).error(function(){e?e(h.name,a).then(function(b){f&&(b=f(b)),h.tables[a]=b,g.resolve(b)},function(){g.reject(h.name)}):g.reject(h.name)})}return g.promise};var f={};this.addPart=function(d){if(!c(d))throw new TypeError("Couldn't add part, part name has to be a string!");return b(d)||(f[d]=new a(d)),f[d].isActive=!0,this},this.setPart=function(d,e,g){if(!c(d))throw new TypeError("Couldn't set part.`lang` parameter has to be a string!");if(!c(e))throw new TypeError("Couldn't set part.`part` parameter has to be a string!");if("object"!=typeof g||null===g)throw new TypeError("Couldn't set part. `table` parameter has to be an object!");return b(e)||(f[e]=new a(e),f[e].isActive=!1),f[e].tables[d]=g,this},this.deletePart=function(a){if(!c(a))throw new TypeError("Couldn't delete part, first arg has to be string.");return b(a)&&(f[a].isActive=!1),this},this.isPartAvailable=d,this.$get=["$rootScope","$injector","$q","$http",function(g,h,i,j){var k=function(a){function d(a){m.push(a)}if(!c(a.key))throw new TypeError("Unable to load data, a key is not a non-empty string.");if(!c(a.urlTemplate))throw new TypeError("Unable to load data, a urlTemplate is not a non-empty string.");var g=a.loadFailureHandler;if(void 0!==g){if(!angular.isString(g))throw new Error("Unable to load data, a loadFailureHandler is not a string.");g=h.get(g)}var k=a.fileFormatAdapter;if(void 0!==k&&!angular.isFunction(k))throw new Error("Unable to load data, a fileFormatAdapter is not a function!");var l=[],m=[],n=i.defer();for(var o in f)b(o)&&f[o].isActive&&l.push(f[o].getTable(a.key,i,j,a.urlTemplate,g,k).then(d));return l.length?i.all(l).then(function(){for(var a={},b=0;b<m.length;b++)e(a,m[b]);n.resolve(a)},function(){n.reject(a.key)}):n.resolve({}),n.promise};return k.addPart=function(d){if(!c(d))throw new TypeError("Couldn't add part, first arg has to be a string");return b(d)?f[d].isActive||(f[d].isActive=!0,g.$emit("$translatePartialLoaderStructureChanged",d)):(f[d]=new a(d),g.$emit("$translatePartialLoaderStructureChanged",d)),k},k.deletePart=function(a,d){if(!c(a))throw new TypeError("Couldn't delete part, first arg has to be string");if(void 0===d)d=!1;else if("boolean"!=typeof d)throw new TypeError("Invalid type of a second argument, a boolean expected.");if(b(a)){var e=f[a].isActive;d?delete f[a]:f[a].isActive=!1,e&&g.$emit("$translatePartialLoaderStructureChanged",a)}return k},k.isPartAvailable=d,k}]});