define(["amd!cdf/lib/underscore","./AbstractSelect"],function(e,t){return t.SelectionStrategies.MultiSelect=t.SelectionStrategies.AbstractSelect.extend({ID:"BaseFilter.SelectionStrategies.MultiSelect",setSelection:function(e,t){return t.setAndUpdateSelection(e),e
}}),t.SelectionStrategies.LimitedSelect=t.SelectionStrategies.MultiSelect.extend({ID:"BaseFilter.SelectionStrategies.LimitedSelect",constructor:function(e){return this.selectionLimit=e.limit||1/0
},setSelection:function(i,n){var l,c,o,s;return l=!0,o=n.getSelection(),i=this.getNewState(o),i!==t.Enum.select.NONE&&(s=n.root().get("numberOfSelectedItems"),e.isFinite(s)||(n.update(),s=n.root().get("numberOfSelectedItems")),s>=this.selectionLimit?(this.warn('Cannot allow the selection of  "'+n.get("label")+'". Selection limit of '+this.selectionLimit+" has been reached."),l=!1):n.children()&&i===t.Enum.select.ALL&&(c=n.flatten().filter(function(e){return null==e.children()
}).filter(function(e){return e.getSelection()===t.Enum.select.NONE}).value().length,s+c>=this.selectionLimit&&(this.warn('Cannot allow the selection of "'+n.get("label")+'". Selection limit of '+this.selectionLimit+" would be reached."),l=!1))),l?(this.debug("setSelection"),n.setAndUpdateSelection(i),s=n.root().get("numberOfSelectedItems"),n.root().set("reachedSelectionLimit",s>=this.selectionLimit)):i=o,i
}}),t});